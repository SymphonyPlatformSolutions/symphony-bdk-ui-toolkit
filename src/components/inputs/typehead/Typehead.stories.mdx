import Box from "../../layout/box";
import Text from "../../misc/text";
import {
  Story,
  Meta,
  Preview,
  Props,
  Link
} from "@storybook/addon-docs/blocks";
import Typehead from './index';
import { TypeheadWrapper } from './samples/controller';
import { CustomChevron } from './samples/custom-chevron';

<Meta title="components/Inputs/Typehead" />

# Typehead

<hr />

<Preview>
  <Story name="Base">
    <Box align="center">
      <Box style={{ height: '150px'}}>
        <TypeheadWrapper />
      </Box>
    </Box>
  </Story>
</Preview>

Typehead is a simple component that acts as a dropdown, but only activates when typed. It ships with a simple content based search that can be used.

This component, like most Inputs, is a controlled component, therefore it will usually be wrapped
by a controller, and have its state and logic controlled by a parent.

```jsx
import React, { useState } from 'react';
import Typehead, { simpleFilter } from '../index';
import Box from '../../../layout/box';

const DATA = [
  'Thing',
  'Stuff',
  'Data',
  'Value',
];

export const TypeheadWrapper = (props) => {
  const [currentData, setCurrentData] = useState([]);
  const [currentValue, setCurrentValue] = useState(null);

  return (
    <Box type="secondary">
      <Box horizontal style={{ width: '400px' }}>
        <Typehead
          {...props}
          value={currentValue}
          data={currentData}
          onChange={newValue => {
            setCurrentData(simpleFilter(DATA, newValue));
            setCurrentValue(newValue);
          }}
        />
      </Box>
    </Box>
  );
};
```

## Use

As with any input, it must be referred to by an onChange and value pairs, with the addition of a ```data``` prop. This must be an array of strings that correspond to the current possible values.

Also boasts of a period that counts as debounce. If set to 0, ignores the lag.

## Size

<Preview>
  <Story name="Size">
    <Box style={{ height: '150px'}}>
      <TypeheadWrapper size="large" />
    </Box>
  </Story>
</Preview>

## States

<Preview>
  <Story name="States">
    <Box>
      <Box>
        <TypeheadWrapper errorMessage="Something's amiss!" />
      </Box>
      <Box>
        <TypeheadWrapper disabled />
      </Box>
      <Box style={{ height: '150px'}}>
        <TypeheadWrapper loading />
      </Box>
    </Box>
  </Story>
</Preview>

## Custom Chevron

The component can also import a custom Chevron Component through the ```ChevronComponent``` prop.
The ChevronComponent will be called with 4 props:
- ```disabled```
- ```focusInput```
- ```blurInput```
- ```menuIsOpen```
Here's an example of a custom Chevron Component:

```jsx
const SmileContainer = styled.div`
  display: flex;
  height: 16px;
  align-items: center;
  transition: all 0.3s ease-out;
  transform: rotate(${({ menuIsOpen }) => (menuIsOpen ? '-180deg' : 0)});
  cursor: pointer;
`;

const StyledSmile = styled(Smile)`
  transition: all 0.3s;
  color: ${({ theme, menuIsOpen }) => (menuIsOpen ? theme.colors.warning_500 : theme.colors.grey_500)};
`;
export const CustomChevron = ({ menuIsOpen, blurInput, focusInput }) => (
  <SmileContainer
    onMouseDown={e => {
      e.preventDefault();
      if (menuIsOpen) {
        blurInput();
      } else {
        focusInput();
      }
    }}
    menuIsOpen={menuIsOpen}
  >
    <StyledSmile size={20} menuIsOpen={menuIsOpen} />
  </SmileContainer>
);
```

It is also possible to hide the Chevron altogether (be it the Custom component or the default one) by passing the ```hideChevron``` prop.

<Preview>
    <Story name="Custom Chevron">
      <Box style={{ height: '150px'}}>
        <Box>
          <TypeheadWrapper CustomChevron={CustomChevron} />
        </Box>
      </Box>
    </Story>
</Preview>

<Props of={Typehead} />
